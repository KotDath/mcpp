---
phase: 09-inspector-server-integration
plan: 03
type: execute
wave: 2
depends_on: [09-01, 09-02]
files_modified:
  - examples/mcp.json
  - examples/TESTING.md
autonomous: false

must_haves:
  truths:
    - "mcp.json config file exists in examples directory"
    - "mcp.json references built inspector_server executable"
    - "Paths in mcp.json are relative to config file location"
    - "TESTING.md documents manual testing workflow with MCP Inspector"
    - "TESTING.md includes prerequisites, build steps, and example commands"
  artifacts:
    - path: "examples/mcp.json"
      provides: "MCP Inspector CLI configuration"
      contains: '"mcpServers"'
    - path: "examples/TESTING.md"
      provides: "Manual testing documentation"
      contains: "MCP Inspector"
      min_lines: 50
  key_links:
    - from: "examples/mcp.json"
      to: "build/examples/inspector_server"
      via: "command field in mcpServers entry"
      pattern: '"command"'
    - from: "examples/TESTING.md"
      to: "examples/mcp.json"
      via: "Documentation reference"
      pattern: "mcp\\.json"
---

<objective>
Create mcp.json configuration for MCP Inspector CLI and TESTING.md documentation for manual testing workflow.

Purpose: Enable standard Inspector CLI testing of the example server and document the process for users. This completes the Inspector integration by providing the configuration file and usage instructions.

Output: mcp.json in examples directory and TESTING.md with complete testing instructions.
</objective>

<execution_context>
@/home/kotdath/.claude/get-shit-done/workflows/execute-plan.md
@/home/kotdath/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/phases/09-inspector-server-integration/09-CONTEXT.md
@.planning/phases/09-inspector-server-integration/09-RESEARCH.md

@examples/inspector_server.cpp

# Key: mcp.json format from MCP Inspector docs
# {
#   "mcpServers": {
#     "server-name": {
#       "command": "./path/to/executable",
#       "args": [],
#       "env": {"KEY": "value"}
#     }
#   }
# }

# Key: Inspector commands from research
# npx @modelcontextprotocol/inspector --config examples/mcp.json
# npx @modelcontextprotocol/inspector --cli node build/examples/inspector_server --method tools/list
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create mcp.json configuration file</name>
  <files>examples/mcp.json</files>
  <action>
    Create examples/mcp.json with the following content:

    ```json
    {
      "mcpServers": {
        "mcpp-inspector-server": {
          "command": "../../build/examples/inspector_server",
          "args": [],
          "env": {
            "MCPP_DEBUG": "1"
          }
        }
      }
    }
    ```

    Path explanation:
    - File is in examples/ directory
    - Command path is "../../build/examples/inspector_server" (relative to examples/mcp.json)
    - This resolves to project-root/build/examples/inspector_server
    - MCPP_DEBUG=1 enables debug output to stderr

    Do NOT use absolute paths - relative paths work from any location.
  </action>
  <verify>test -f examples/mcp.json && jq empty examples/mcp.json 2>/dev/null || cat examples/mcp.json</verify>
  <done>mcp.json created with relative path to built inspector_server executable</done>
</task>

<task type="auto">
  <name>Task 2: Create TESTING.md with manual testing instructions</name>
  <files>examples/TESTING.md</files>
  <action>
    Create examples/TESTING.md with comprehensive testing documentation.

    Include the following sections:
    1. Title and brief description
    2. Prerequisites (Node.js version, Inspector via npx)
    3. Building the example server
    4. UI Mode testing (interactive)
    5. CLI Mode testing (scriptable)
    6. Expected output examples
    7. Troubleshooting common issues

    Content structure:
    ```markdown
    # Testing mcpp with MCP Inspector

    This guide explains how to test the mcpp example server using the MCP Inspector CLI tool.

    ## Prerequisites

    - Node.js ^22.7.5 (required for MCP Inspector)
    - Built mcpp library and examples
    - npx (comes with Node.js)

    ## Building

    From the project root:
    \`\`\`bash
    mkdir -p build && cd build
    cmake ..
    make
    \`\`\`

    Verify the example server exists:
    \`\`\`bash
    ls -la build/examples/inspector_server
    \`\`\`

    ## UI Mode (Interactive Testing)

    Start Inspector with the mcp.json config:
    \`\`\`bash
    npx @modelcontextprotocol/inspector --config examples/mcp.json
    \`\`\`

    Or directly with the executable:
    \`\`\`bash
    npx @modelcontextprotocol/inspector node build/examples/inspector_server
    \`\`\`

    The Inspector UI will open at http://localhost:6274

    ### Testing Tools

    1. Click "Tools" in the sidebar
    2. Click "calculate" tool
    3. Enter arguments: `{"operation": "add", "a": 5, "b": 3}`
    4. Click "Call Tool"
    5. Expected result: `{"content": [{"type": "text", "text": "8"}]}`

    ### Testing Resources

    1. Click "Resources" in the sidebar
    2. Click "List Resources"
    3. Expected: file://tmp/mcpp_test.txt and info://server

    ### Testing Prompts

    1. Click "Prompts" in the sidebar
    2. Click "List Prompts"
    3. Expected: code_review prompt

    ## CLI Mode (Scriptable Testing)

    ### List Tools
    \`\`\`bash
    npx @modelcontextprotocol/inspector --cli node build/examples/inspector_server \\
        --method tools/list
    \`\`\`

    ### Call a Tool
    \`\`\`bash
    npx @modelcontextprotocol/inspector --cli node build/examples/inspector_server \\
        --method tools/call \\
        --tool-name calculate \\
        --tool-arg operation=add \\
        --tool-arg a=42 \\
        --tool-arg b=8
    \`\`\`

    Expected output:
    \`\`\`json
    {
      "content": [
        {"type": "text", "text": "50"}
      ]
    }
    \`\`\`

    ### List Resources
    \`\`\`bash
    npx @modelcontextprotocol/inspector --cli node build/examples/inspector_server \\
        --method resources/list
    \`\`\`

    ### List Prompts
    \`\`\`bash
    npx @modelcontextprotocol/inspector --cli node build/examples/inspector_server \\
        --method prompts/list
    \`\`\`

    ## Manual Stdio Testing

    For quick debugging without Inspector:
    \`\`\`bash
    echo '{"jsonrpc":"2.0","method":"tools/list","id":1}' | ./build/examples/inspector_server
    \`\`\`

    Expected: Valid JSON-RPC response with tools array.

    ## Troubleshooting

    ### "command not found: npx"
    Install Node.js from https://nodejs.org/ (version 22.7.5 or later)

    ### "Cannot find module @modelcontextprotocol/inspector"
    Wait for npx to download the package (first run may take a minute)

    ### Inspector shows "Connection failed"
    - Verify server builds: `make inspector_server`
    - Check executable exists: `ls build/examples/inspector_server`
    - Try manual test: `echo '{"jsonrpc":"2.0","id":1,"method":"initialize","params":{}}' | ./build/examples/inspector_server`

    ### No tools/resources/prompts appear
    - Check debug output (stderr) for validation errors
    - Verify MCPP_DEBUG=1 is set in mcp.json env
    - Test with manual stdio command above

    ### Parse error responses
    After Phase 9, parse errors should include the request ID:
    \`\`\`json
    {"jsonrpc":"2.0","error":{"code":-32700,"message":"Parse error"},"id":null}
    \`\`\`

    ## See Also

    - MCP Inspector Documentation: https://modelcontextprotocol.io/docs/tools/inspector
    - MCP Inspector GitHub: https://github.com/modelcontextprotocol/inspector
    ```
  </action>
  <verify>test -f examples/TESTING.md && grep -q "MCP Inspector" examples/TESTING.md</verify>
  <done>TESTING.md created with prerequisites, build steps, UI mode, CLI mode, and troubleshooting sections</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
    Complete Inspector integration:
    - examples/mcp.json configuration file
    - examples/TESTING.md documentation
    - inspector_server.cpp updated with from_json() validation
  </what-built>
  <how-to-verify>
    1. Build the project: `cd build && make`
    2. Start Inspector: `npx @modelcontextprotocol/inspector --config examples/mcp.json`
    3. In the Inspector UI (opens at http://localhost:6274):
       - Click "Tools" and verify calculate, echo, get_time appear
       - Call calculate with operation=add, a=5, b=3
       - Verify result shows "8"
       - Click "Resources" and verify resources appear
       - Click "Prompts" and verify prompts appear
    4. Try CLI mode:
       ```bash
       npx @modelcontextprotocol/inspector --cli node build/examples/inspector_server --method tools/list
       ```
    5. Test parse error handling:
       ```bash
       echo 'invalid json' | ./build/examples/inspector_server
       ```
       Verify error response includes proper structure.

    If all tests pass, the Inspector integration is complete.
  </how-to-verify>
  <resume-signal>Type "approved" if Inspector testing succeeds, or describe issues encountered</resume-signal>
</task>

</tasks>

<verification>
- [ ] examples/mcp.json exists with valid JSON structure
- [ ] mcp.json references ../../build/examples/inspector_server
- [ ] examples/TESTING.md exists with complete documentation
- [ ] TESTING.md includes prerequisites, build, UI mode, CLI mode sections
- [ ] Manual testing with MCP Inspector succeeds
- [ ] tools/list, tools/call, resources/list, prompts/list all work
</verification>

<success_criteria>
MCP Inspector can connect to inspector_server and successfully call tools, list resources, and list prompts.
</success_criteria>

<output>
After completion, create `.planning/phases/09-inspector-server-integration/09-03-SUMMARY.md`
</output>
