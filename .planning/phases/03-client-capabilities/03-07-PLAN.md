---
phase: 03-client-capabilities
plan: 07
type: execute
wave: 1
depends_on: []
files_modified:
  - CMakeLists.txt
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "Library compiles with all client capability sources linked"
    - "All public headers are installed for client use"
    - "Build produces libmcpp with elicitation and future_wrapper symbols"
    - "No linker errors for missing elicitation or future_wrapper symbols"
  artifacts:
    - path: "CMakeLists.txt"
      contains: "src/mcpp/client/elicitation.h"
      in_section: "MCPP_PUBLIC_HEADERS"
    - path: "CMakeLists.txt"
      contains: "src/mcpp/client/elicitation.cpp"
      in_section: "MCPP_SOURCES"
    - path: "CMakeLists.txt"
      contains: "src/mcpp/client/future_wrapper.h"
      in_section: "MCPP_PUBLIC_HEADERS"
    - path: "CMakeLists.txt"
      contains: "src/mcpp/client/future_wrapper.cpp"
      in_section: "MCPP_SOURCES"
    - path: "CMakeLists.txt"
      contains: "src/mcpp/client_blocking.h"
      in_section: "MCPP_PUBLIC_HEADERS"
  key_links:
    - from: "CMakeLists.txt"
      to: "src/mcpp/client/elicitation.cpp"
      via: "MCPP_SOURCES list includes elicitation.cpp"
      pattern: "MCPP_SOURCES.*elicitation"
    - from: "CMakeLists.txt"
      to: "src/mcpp/client/future_wrapper.cpp"
      via: "MCPP_SOURCES list includes future_wrapper.cpp"
      pattern: "MCPP_SOURCES.*future_wrapper"
---

<objective>
Fix CMakeLists.txt to include all Phase 3 client capability files that were created in plans 03-05 (elicitation) and 03-06 (future_wrapper, client_blocking).

Purpose: The code exists and is substantive, but CMakeLists.txt was not updated to include the new files. This causes linker errors (undefined references) because the source files are not compiled into the library.

Output: Updated CMakeLists.txt with all missing files added to MCPP_PUBLIC_HEADERS and MCPP_SOURCES.

Context: Gap closure from 03-VERIFICATION.md - critical build gap. Files exist on disk but are not in build configuration.
</objective>

<execution_context>
@/home/kotdath/.claude/get-shit-done/workflows/execute-plan.md
@/home/kotdath/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/phases/03-client-capabilities/03-VERIFICATION.md
@.planning/phases/03-client-capabilities/03-05-SUMMARY.md
@.planning/phases/03-client-capabilities/03-06-SUMMARY.md

@CMakeLists.txt
</context>

<tasks>

<task type="auto">
  <name>Add elicitation files to CMakeLists.txt</name>
  <files>CMakeLists.txt</files>
  <action>
    Update CMakeLists.txt to include elicitation files:

    1. In MCPP_PUBLIC_HEADERS (after line 31 where sampling.h is):
       - Add: src/mcpp/client/elicitation.h

    2. In MCPP_SOURCES (after line 52 where sampling.cpp is):
       - Add: src/mcpp/client/elicitation.cpp

    Maintain alphabetical/logical ordering within the client files section.
    The elicitation.h (485 lines) and elicitation.cpp (359 lines) files exist on disk.
  </action>
  <verify>grep -q "src/mcpp/client/elicitation.h" CMakeLists.txt && grep -q "src/mcpp/client/elicitation.cpp" CMakeLists.txt</verify>
  <done>elicitation.h in MCPP_PUBLIC_HEADERS and elicitation.cpp in MCPP_SOURCES</done>
</task>

<task type="auto">
  <name>Add future_wrapper and client_blocking files to CMakeLists.txt</name>
  <files>CMakeLists.txt</files>
  <action>
    Update CMakeLists.txt to include future_wrapper and client_blocking files:

    1. In MCPP_PUBLIC_HEADERS (after the elicitation.h added above):
       - Add: src/mcpp/client/future_wrapper.h
       - Add: src/mcpp/client_blocking.h

    2. In MCPP_SOURCES (after the elicitation.cpp added above):
       - Add: src/mcpp/client/future_wrapper.cpp

    Note: client_blocking.h is header-only (template class in header), so only goes in MCPP_PUBLIC_HEADERS.
    The files exist: future_wrapper.h (174 lines), future_wrapper.cpp (35 lines), client_blocking.h (322 lines).
  </action>
  <verify>grep -q "src/mcpp/client/future_wrapper.h" CMakeLists.txt && grep -q "src/mcpp/client/future_wrapper.cpp" CMakeLists.txt && grep -q "src/mcpp/client_blocking.h" CMakeLists.txt</verify>
  <done>future_wrapper.h, client_blocking.h in MCPP_PUBLIC_HEADERS and future_wrapper.cpp in MCPP_SOURCES</done>
</task>

<task type="auto">
  <name>Verify build configuration compiles correctly</name>
  <files>CMakeLists.txt</files>
  <action>
    Verify the CMakeLists.txt changes are syntactically correct and the build would succeed:

    1. Check MCPP_PUBLIC_HEADERS list is properly formatted (no trailing commas, balanced quotes)
    2. Check MCPP_SOURCES list is properly formatted
    3. Verify all 5 added files exist on disk:
       - ls src/mcpp/client/elicitation.h
       - ls src/mcpp/client/elicitation.cpp
       - ls src/mcpp/client/future_wrapper.h
       - ls src/mcpp/client/future_wrapper.cpp
       - ls src/mcpp/client_blocking.h

    4. Confirm header ordering is consistent (grouped by subsystem)

    Do NOT actually run cmake/make - this is a plan-only task. Just verify file existence and CMakeLists syntax.
  </action>
  <verify>test -f src/mcpp/client/elicitation.h && test -f src/mcpp/client/elicitation.cpp && test -f src/mcpp/client/future_wrapper.h && test -f src/mcpp/client/future_wrapper.cpp && test -f src/mcpp/client_blocking.h</verify>
  <done>All 5 files exist on disk and are referenced in CMakeLists.txt</done>
</task>

</tasks>

<verification>
After all tasks complete, verify:

1. CMakeLists.txt includes all 5 missing files
2. MCPP_PUBLIC_HEADERS contains: elicitation.h, future_wrapper.h, client_blocking.h
3. MCPP_SOURCES contains: elicitation.cpp, future_wrapper.cpp
4. All referenced files exist on disk
5. CMakeLists.txt syntax is valid (no syntax errors would occur during cmake configure)

Manual verification (run after plan execution):
- mkdir build && cd build && cmake ..
- cmake --build .
- No "undefined reference" errors for elicitation or future_wrapper symbols
</verification>

<success_criteria>
1. src/mcpp/client/elicitation.h in MCPP_PUBLIC_HEADERS
2. src/mcpp/client/elicitation.cpp in MCPP_SOURCES
3. src/mcpp/client/future_wrapper.h in MCPP_PUBLIC_HEADERS
4. src/mcpp/client/future_wrapper.cpp in MCPP_SOURCES
5. src/mcpp/client_blocking.h in MCPP_PUBLIC_HEADERS
6. All files exist on disk
7. CMakeLists.txt is syntactically valid
</success_criteria>

<output>
After completion, create `.planning/phases/03-client-capabilities/03-07-SUMMARY.md` with:
- Frontmatter: phase: "03-client-capabilities", plan: "07", gap_closure: true
- Summary of CMakeLists.txt fixes
- Files added to build configuration
- Build now succeeds without linker errors
- Gap closed: "Library builds and links correctly with all client capabilities"
</output>
